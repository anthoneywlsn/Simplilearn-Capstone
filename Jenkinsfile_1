pipeline {
    agent any
    
    tools {nodejs "nodejs"}
    
    environment {
      AWS_ACCOUNT_ID="195879934828"
      AWS_DEFAULT_REGION="us-east-2a" 
      CLUSTER_NAME="capstone-Aetna-cluster"
      SERVICE_NAME="simplilearn-capstone-nodejs-container-service"
      TASK_DEFINITION_NAME="aetna-capstone-definition"
      DESIRED_COUNT="1"
      IMAGE_REPO_NAME="simplilearn-capstone-pvt-repo"
      IMAGE_TAG="${env.BUILD_ID}"
      REPOSITORY_URI="${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_DEFAULT_REGION}.amazonaws.com/${IMAGE_REPO_NAME}"
      registryCredential="aws-iam-user"
      CI = 'true'
    }
   
    stages {
      stage('Build') { 
        steps {
          nodejs(nodeJSInstallationName: 'Node 6.x', configId: '<config-file-provider-id>') {
          sh 'npm config ls'
          }
          sh 'npm install'
        }
      }
    }
  }
